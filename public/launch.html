<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>UEF Controller</title>
</head>
<body>
    <script>
        // 1. Handshake with Blackboard
        var myOrigin = window.location.origin; 
        
        console.log("ðŸš€ UEF Controller Loaded. Sending Hello...");
        window.parent.postMessage({ type: "integration:hello" }, "*");

        // 2. Wait for Authorization
        window.addEventListener("message", function(event) {
            var data = event.data;

            if (data.type === "integration:authorize") {
                console.log("âœ… UEF Authorized! Registering Help Item...");

                // 3. Register a Help Item (The reliable way)
                // This adds a link to the Blackboard Help Menu (?)
                var registerHelpCommand = {
                    type: "integration:help:register",
                    payload: {
                        id: "noodle-factory-chat",
                        title: "Chat with NoodleFactory AI", // Text in the menu
                        url: "https://uef-integ-final.onrender.com/chat.html" // Opens the visible chat
                    }
                };

                window.parent.postMessage(registerHelpCommand, "*");
                console.log("ðŸ“© Help Item Registered. Check the '?' menu!");
            }
        });
    </script>
</body>
</html>

