<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UEF Widget Launch</title>

    <style>
      body {
        font-family: sans-serif;
        background: #f5f5f5;
        text-align: center;
        padding: 20px;
      }
      .status {
        color: green;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h2>NoodleFactory Widget Loader</h2>
    <p>Status: <span id="status">Initializing...</span></p>

    <script>
      // Notify Blackboard that the integration has loaded
      window.parent.postMessage({ type: "integration:hello" }, "*");

      // Listen for Blackboard's authorization response
      window.addEventListener("message", function (event) {
        var data = event.data;

        // If Blackboard authorizes us, we are good to go
        if (data.type === "integration:authorize") {
          console.log("‚úÖ UEF: Authorized by Blackboard!");
          document.getElementById("status").innerText = "Authorized & Running";
          document.getElementById("status").className = "status";

          // You can add logic here to open a panel if needed
          // Example: window.parent.postMessage({ type: "integration:open-panel" ... }, "*");
        }
      });
    </script>

    <script type="text/javascript">
      console.log("üçú NoodleFactory script is loading...");
      var $_Widget = $_Widget || {},
        $_NFW = $_NFW || {};
      (function () {
        var s1 = document.createElement("script"),
          s0 = document.getElementsByTagName("script")[0];
        s1.async = true;
        s1.src =
          "https://portalapi.noodlefactory.ai/api/v1/widget/widget-sdk/A60CF5EFD2705979/widget.js";
        s1.charset = "UTF-8";
        s1.setAttribute("crossorigin", "*");
        s1.setAttribute("id", "sw-widget");
        s1.onload = function () {
          $_NFW.initialize();
          console.log("üçú NoodleFactory initialized!");
        };
        s0.parentNode.insertBefore(s1, s0);
      })();
    </script>
  </body>
</html>
