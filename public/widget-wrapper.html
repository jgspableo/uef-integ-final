<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>NF Widget Wrapper</title>

    <style>
      html, body {
        width: 100%;
        height: 100%;
        margin: 0;
      }

      body {
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        background: transparent;
      }

      #nf-root {
        position: relative;
        width: 100%;
        height: 100%;
      }

      #nf-status {
        position: absolute;
        left: 12px;
        top: 12px;
        padding: 8px 10px;
        border-radius: 10px;
        background: rgba(0,0,0,.06);
        font-size: 12px;
        line-height: 1.35;
        max-width: calc(100% - 24px);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
    </style>
  </head>

  <body>
    <div id="nf-root">
      <div id="nf-status">Loading NF widget…</div>
    </div>

    <script>
      (function () {
        const statusEl = document.getElementById("nf-status");
        const setStatus = (s) => { if (statusEl) statusEl.textContent = s; };

        function fixPinnedButton() {
          const btn =
            document.querySelector(".noodle-factory-button-wrapper") ||
            document.querySelector(".noodle-factory-button");

          if (!btn) return;

          btn.style.position = "fixed";
          btn.style.right = "16px";
          btn.style.bottom = "16px";
          btn.style.left = "auto";
          btn.style.top = "auto";
          btn.style.transform = "none";
          btn.style.zIndex = "2147483000";

          const wrapper = document.querySelector(".noodle-factory-widget-wrapper");
          if (wrapper) {
            wrapper.style.overflow = "visible";
            wrapper.style.position = "fixed";
            wrapper.style.inset = "0";
            wrapper.style.zIndex = "2147483000";
          }
        }

        const mo = new MutationObserver(() => {
          const hasWidget =
            !!document.querySelector(".noodle-factory-widget-wrapper") ||
            !!document.querySelector(".noodle-factory-button-wrapper");

          if (hasWidget) {
            setStatus("NF widget detected ✅");
            setTimeout(() => {
              fixPinnedButton();
              window.dispatchEvent(new Event("resize"));
            }, 50);
          }
        });

        mo.observe(document.documentElement, { childList: true, subtree: true });
        window.addEventListener("resize", () => setTimeout(fixPinnedButton, 50));

        window.__nfDebug = () => ({
          href: location.href,
          vw: document.documentElement.clientWidth,
          vh: document.documentElement.clientHeight,
          hasWrapper: !!document.querySelector(".noodle-factory-widget-wrapper"),
          hasButton: !!document.querySelector(".noodle-factory-button-wrapper"),
        });

        setStatus("Waiting for NF widget DOM…");
      })();
    </script>

    <!-- IMPORTANT:
         Load the NF widget SDK directly.
         Do NOT defer/async until the SDK is stable in this environment. -->
    <script src="https://portalapi.noodlefactory.ai/api/v1/widget/widget-sdk/A60CF5EFD2705979/widget.js"></script>
  </body>
</html>
